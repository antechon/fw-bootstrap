apiVersion: source.toolkit.fluxcd.io/v1beta2
kind: OCIRepository
metadata:
  name: bootstrap-gke-oci
  namespace: flux-system
spec:
  interval: 1m0s
  provider: generic
  secretRef:
    name: ghcr-secret
  ref:
    tag: main
  url: oci://ghcr.io/den-vasyliev/fw-bootstrap
---
apiVersion: infra.contrib.fluxcd.io/v1alpha2
kind: Terraform
metadata:
  name: bootstrap-gke-tf
  namespace: flux-system
spec:
  path: ./
  approvePlan: ""
  interval: 1m
  storeReadablePlan: human
  sourceRef:
    kind: OCIRepository
    name: bootstrap-gke-oci
    namespace: flux-system
  writeOutputsToSecret:
  name: terraform-gke-outputs
  vars:
  - name: project_id
    value: k8s-k3s